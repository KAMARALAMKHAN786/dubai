(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[74],{4484:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin-dashboard",function(){return n(5430)}])},5430:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>m});var s=n(5507),r=n(3003),a=n.n(r),o=n(7851),i=n(6392),l=n(269),c=n.n(l),u=n(5041),d=n(9269),p=n(6666),g=o.createElement;function m(){var e,t,n,r=(0,p.A)(),l=r.user,m=r.loading,f=(0,i.useRouter)(),x=(0,o.useState)([]),v=x[0],b=x[1],h=(0,o.useState)(!0),N=h[0],y=h[1],w=(0,o.useState)("all"),A=w[0],E=w[1],_=(0,o.useState)("newest"),j=_[0],C=_[1],k=(0,o.useState)("listings"),S=k[0],L=k[1];(0,o.useEffect)(function(){if(!l&&!m){d.Ay.error("You must be logged in to access the admin dashboard"),f.push("/admin-login");return}l&&(P(),console.log("Current authenticated user:",l))},[l,m,f,A,j]);var P=(e=(0,s.A)(a().mark(function e(){var t,n,s,r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),t=u.N.from("listings").select("*"),"all"!==A&&(t=t.eq("status",A)),t=t.order("created_at",{ascending:"oldest"===j}),e.next=6,t;case 6:s=(n=e.sent).data,(r=n.error)?(d.Ay.error("Error fetching listings"),console.error("Error fetching listings:",r)):b(s||[]),y(!1);case 11:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)}),R=(t=(0,s.A)(a().mark(function e(t){var n,s,r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Approving listing with id: ".concat(t)),console.log("Listing found:",v.find(function(e){return e.id===t})),e.next=5,u.N.from("listings").update({status:"approved"}).eq("id",t);case 5:s=(n=e.sent).data,(r=n.error)?(d.Ay.error("Error approving listing"),console.error("Error approving listing:",r)):(d.Ay.success("Listing approved successfully"),console.log("Update response:",s),P());case 9:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),U=(n=(0,s.A)(a().mark(function e(t){var n,s,r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Rejecting listing with id: ".concat(t)),console.log("Listing found:",v.find(function(e){return e.id===t})),e.next=5,u.N.from("listings").update({status:"rejected"}).eq("id",t);case 5:s=(n=e.sent).data,(r=n.error)?(d.Ay.error("Error rejecting listing"),console.error("Error rejecting listing:",r)):(d.Ay.success("Listing rejected successfully"),console.log("Update response:",s),P());case 9:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),D=function(e){switch(e){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-yellow-100 text-yellow-800"}},F=function(e){switch(null==e?void 0:e.toLowerCase()){case"pro":return"bg-purple-100 text-purple-800";case"team":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return m||N?g("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"},g("div",{className:"flex justify-center items-center"},g("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"}))):g("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"},g("div",{className:"flex justify-between items-center mb-8"},g("h1",{className:"text-3xl font-bold text-white"},"Admin Dashboard"),g("div",{className:"flex space-x-4"},g("button",{className:"px-4 py-2 rounded-md ".concat("listings"===S?"bg-blue-600 text-white":"bg-[gray-200] text-gray-800"),onClick:function(){return L("listings")}},"Manage Listings"),g("button",{className:"px-4 py-2 rounded-md ".concat("blogs"===S?"bg-blue-600 text-white":"bg-gray-200 text-gray-800"),onClick:function(){return L("blogs")}},"Manage Blogs"))),"listings"===S&&g(o.Fragment,null,g("div",{className:"flex space-x-4 mb-8"},g("select",{value:A,onChange:function(e){return E(e.target.value)},className:"rounded-md border-gray-300"},g("option",{value:"all"},"All Status"),g("option",{value:"pending"},"Pending"),g("option",{value:"approved"},"Approved"),g("option",{value:"rejected"},"Rejected")),g("select",{value:j,onChange:function(e){return C(e.target.value)},className:"rounded-md border-gray-300"},g("option",{value:"newest"},"Newest First"),g("option",{value:"oldest"},"Oldest First"))),g("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg"},g("div",{className:"divide-y divide-gray-200"},v.map(function(e){var t;return g("div",{key:e.id,className:"p-6 hover:bg-gray-50"},g("div",{className:"flex items-center justify-between"},g("div",{className:"flex-1"},g("div",{className:"flex items-center justify-between"},g("h3",{className:"text-xl font-semibold text-gray-900"},e.title),g("div",{className:"flex space-x-2"},g("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(D(e.status))},e.status.charAt(0).toUpperCase()+e.status.slice(1)),g("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(F(e.payment_plan))},(t=e.payment_plan)?t.toUpperCase():"FREE"))),g("div",{className:"mt-2 text-sm text-gray-500"},g("p",{className:"mb-2"},e.description),g("div",{className:"grid grid-cols-2 gap-4 mt-4"},g("div",null,g("p",null,g("span",{className:"font-medium"},"Category:")," ",e.category),g("p",null,g("span",{className:"font-medium"},"Price:")," AED ",e.price),g("p",null,g("span",{className:"font-medium"},"Created:")," ",new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))),g("div",null,g("p",null,g("span",{className:"font-medium"},"Phone:")," ",e.phone||"N/A"),g("p",null,g("span",{className:"font-medium"},"Email:")," ",e.email||"N/A")))))),"pending"===e.status&&g("div",{className:"mt-4 flex justify-end space-x-4"},g("button",{onClick:function(){return R(e.id)},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500"},"Approve"),g("button",{onClick:function(){return U(e.id)},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500"},"Reject")))}),0===v.length&&g("div",{className:"p-6 text-center text-gray-500"},"No listings found")))),"blogs"===S&&g("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg"},g("div",{className:"p-6"},g(c(),{href:"/admin/blog-posts",className:"block bg-[#00000091] text-white  px-4 py-2 rounded mb-4"},"Manage Blog Posts"))))}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(4484)),_N_E=e.O()}]);